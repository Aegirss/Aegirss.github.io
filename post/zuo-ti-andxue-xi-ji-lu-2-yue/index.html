<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Gridea静态个人博客">
<meta name="description" content="Think twice, code once.">
<meta name="theme-color" content="#000">
<title>做题&amp;学习记录（2月） | Aegir</title>
<link rel="shortcut icon" href="https://Aegirss.github.io//favicon.ico?v=1583768150812">
<link rel="stylesheet" href="https://Aegirss.github.io//styles/main.css">

<link rel="stylesheet" href="/media/css/pisces.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/github.css" rel="stylesheet">  

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

    <meta name="description" content="做题&学习记录（2月）" />
    <meta name="keywords" content="总结" />
  </head>
  <body>
    <div class="head-top-line"></div>
    <div class="header-box">
      
<div class=" pisces">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>Aegir</span>
            </a>  
          
        </div>
        
          <p class="subtitle">Think twice, code once</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            <li class="nav-item ">
              
                <a href="/">
                  <i class="fa fa-home"></i> 首页
                </a>
              
            </li>
          
            <li class="nav-item ">
              
                <a href="/archives">
                  <i class="fa fa-archive"></i> 归档
                </a>
              
            </li>
          
            <li class="nav-item ">
              
                <a href="/tags">
                  <i class="fa fa-tags"></i> 标签
                </a>
              
            </li>
          
          <li class="nav-item">
            <a>
              <i class="fa fa-search"></i> 搜索
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
    </div>
    <div class="main-continer">
      
      <div class="section-layout pisces ">
        <div class="section-layout-wrapper">
          

<div class="sidebar">
    <div class="sidebar-box box-shadow-wrapper bg-color right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active">文章目录</span>
            <span id="metaSideBar" class="sidebar-title-item">站点概览</span>
          </div>
        </div>
      
      <div class="sidebar-body pisces" id="sidebar_body">
        
          <div class="post-side-meta" id="post_side_meta">
            
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="https://Aegirss.github.io//images/avatar.png"/>
    <p class="site-author-name">Aegir</p>
    <p class="site-description right-motion">精于心，简于形</p>
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">6</span>
        <span class="site-item-stat-name">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">分类</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">标签</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://Aegirss.github.io//atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  
    <div class="sidebar-item sidebar-item-social">
      <div class="social-item">
        
          
            <a href="https://twitter.com/Aegir233">
              <i class="fa fa-twitter"></i> Twitter
            </a>
          
            <a href="https://github.com/Aegirss">
              <i class="fa fa-github"></i> Github
            </a>
          
        
        
      </div>
    </div>
  


  <div class="sidebar-item right-motion sidebar-item-friends">
    <p class="friends-title"><i class="fa fa-globe"></i> 友情链接</p>
    <div class="friends-box">
      
        <p>
          <a href="http://uoj.ac/">【UOJ】</a>
        </p>
      
        <p>
          <a href="https://loj.ac/">【LOJ】</a>
        </p>
      
        <p>
          <a href="https://www.luogu.com.cn/">【Luogu】</a>
        </p>
      
    </div>
  </div>

</div>
          </div>
          <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
            <div class="toc-box right-motion">
  <div class="toc-wrapper  no_compress" id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#202023">2020.2.3</a></li>
<li><a href="#202024">2020.2.4</a></li>
<li><a href="#202025">2020.2.5</a></li>
<li><a href="#202026">2020.2.6</a></li>
<li><a href="#202027">2020.2.7</a></li>
<li><a href="#202028">2020.2.8</a></li>
<li><a href="#202029">2020.2.9</a></li>
<li><a href="#2020210">2020.2.10</a></li>
<li><a href="#2020211">2020.2.11</a></li>
<li><a href="#2020212">2020.2.12</a></li>
<li><a href="#2020213">2020.2.13</a></li>
<li><a href="#2020215">2020.2.15</a></li>
<li><a href="#2020216">2020.2.16</a></li>
<li><a href="#2020218">2020.2.18</a></li>
<li><a href="#2020219">2020.2.19</a></li>
<li><a href="#2020220">2020.2.20</a></li>
<li><a href="#2020221">2020.2.21</a></li>
<li><a href="#2020222">2020.2.22</a></li>
<li><a href="#2020223">2020.2.23</a></li>
<li><a href="#2020224">2020.2.24</a></li>
<li><a href="#2020226">2020.2.26</a></li>
<li><a href="#2020227">2020.2.27</a></li>
<li><a href="#2020229">2020.2.29</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1; 
let active = 'active-show', activeClass = 'active-current';
let tocWrapper = document.querySelector('#toc_wrapper');
let tocContent = tocWrapper.children[0];
let autoNumber = tocWrapper&&tocWrapper.classList.contains('auto-number');

function addTocNumber(elem, deep) {
  if (!elem) {
    return;
  }
  let prop = elem.__proto__;

  if (prop === HTMLUListElement.prototype) {
    for (let i = 0; i < elem.children.length; i++) {
      addTocNumber(elem.children[i], deep + (i + 1) + '.');
    }
  } else if (prop === HTMLLIElement.prototype) {
    // 保存li元素
    lList.push(elem);
    for (let i = 0; i < elem.children.length; i++) {
      let cur = elem.children[i];
      if (cur.__proto__ === HTMLAnchorElement.prototype) {
        if (autoNumber) {
          cur.text =  deep + ' ' + cur.text;
        }
      } else if (cur.__proto__ === HTMLUListElement.prototype) {
        addTocNumber(cur, deep);
      }
    }
  }
}


document.addEventListener('scroll', function(e) {
  if (lList.length <= 0) {
    return;
  }
  let scrollTop = document.scrollingElement.scrollTop;
  let dir;

  if (lastTop - scrollTop > 0) {
    dir = 'up';
  } else {
    dir = 'down';
  }

  lastTop = scrollTop;
  if (scrollTop <= 0) {
    if (lastIndex >= 0 && lastIndex < hList.length) {
      lList[lastIndex].classList.remove(activeClass);
    }
    return;
  }

  let current = 0, hasFind = false;
  for (let i = 0; i < hList.length; i++) {
    if (hList[i].offsetTop > scrollTop) {
      current = i;
      hasFind = true;
      break;
    }
  }
  if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
    current = hList.length - 1;
  } else {
    current--;
  }
  if (dir === 'down') {
    if (current > lastIndex) {
      addActiveClass(current);
      removeActiveClass(lastIndex) 
      lastIndex = current;
      removeParentActiveClass();
      lList[current] && addActiveLiElemment(lList[current].parentElement,tocContent);
    }
  } else {
    if (current < lastIndex) {
      addActiveClass(current);
      removeActiveClass(lastIndex);
      lastIndex = current;
      removeParentActiveClass();
      lList[current] && addActiveLiElemment(lList[current].parentElement,tocContent);
    }
  }
});

function removeParentActiveClass() {
  let parents = tocContent.querySelectorAll('.'+active)
  parents.forEach(function(elem) {
    elem.classList.remove(active);
  });
}

function addActiveClass(index) {
  if (index >= 0 && index < hList.length) {
    lList[index].classList.add(activeClass);
  }
}

function removeActiveClass(index) {
  if (index >= 0 && index < hList.length) {
    lList[index].classList.remove(activeClass);
  }
}

function addActiveLiElemment(elem, parent) {
  if (!elem || elem === parent) {
    return;
  } else {
    if (elem.__proto__ === HTMLLIElement.prototype) {
      elem.classList.add(active);
    }
    addActiveLiElemment(elem.parentElement, parent);
  }
}

function showToc() {
  if (tocWrapper) {
    postBody = document.querySelector('#post_body');
    for (let i = 0; i < postBody.children.length; i++) {
      if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
        hList.push(postBody.children[i]);
      }
    }
    if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
    } else if (tocWrapper.classList.contains('no_compress')){
      tocContent.classList.add('expanded');
    } else {
      if (hList.length > 10) {
        active = 'active-hidden'
        tocContent.classList.add('closed');
      } else {
        tocContent.classList.add('expanded');
      }
    }
  }
}
addTocNumber(tocContent, '');

window.addEventListener('load', function() {
  showToc();
  document.querySelector('#sidebar').style='display: block;';
  tocWrapper.classList.add('toc-active');
  setTimeout(function() {
    if ("createEvent" in document) {
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("scroll", false, true);
      document.dispatchEvent(evt);
    }
    else {
      document.fireEvent("scroll");
    }
  }, 500)
})

</script>
          </div>
        
      </div>
    </div>
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });


  if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
    let hasFix = false;
    let scrollEl = document.querySelector('.main-continer');
    let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
    window.addEventListener('scroll', function(e) {
    if (document.scrollingElement.scrollTop >= limitTop) {
      if (!hasFix) {
        sidebar.classList.add('sidebar-fixed');
        hasFix = true;
      }
    } else {
      if (hasFix) {
        sidebar.classList.remove('sidebar-fixed');
        hasFix = false;
      }
    }
  });
  }
  
</script>
          <div class="section-box box-shadow-wrapper">
            <div class="section bg-color post post-page">
              <div class="article-box">
    <header class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://Aegirss.github.io/post/zuo-ti-andxue-xi-ji-lu-2-yue/">
      做题&amp;学习记录（2月）
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span>发布于</span>
      <span>2020-02-07</span>
    </span>
    
      <span class="meta-item">
        <span class="post-meta-divider pc-show">|</span>
        <i class="fa fa-folder-o"></i>
        <span class="pc-show">分类于</span>
        
          
            <a href="https://Aegirss.github.io/tag/1BGdjUVip/">
              <span>总结</span>
            </a>
          
        
      </span>
      <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>17分钟</span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>3108<span class="pc-show">字数</span></span>
    </span>
  </div>
</header>
</div>
              <div class="post-body next-md-body" id="post_body">
                <h2 id="202023">2020.2.3</h2>
<p>学了一点多项式理论，感觉似懂非懂。。</p>
<p><a href="https://www.luogu.com.cn/problem/P4253">SCOI2015 小凸玩密室</a></p>
<p>首先注意到这是一颗完全二叉树，因为高度很小所以可以枚举每个点作为起点。<br>
然后考虑树形DP，求出每个点往上爬的代价即可。</p>
<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;

typedef long long ll;
const int MAXN = 200010;
#define p(i, j) (((1 &lt;&lt; (j - 1)) &lt;= i) ? (i &gt;&gt; j) : -1)
#define b(i, j) ((i &gt;&gt; (j - 1)) ^ 1)
#define ls (i &lt;&lt; 1)
#define rs (i &lt;&lt; 1 | 1)

int n; ll num[MAXN];
ll dis[MAXN][20], dp[MAXN][20][2];

int main()
{
    scanf(&quot;%d&quot;, &amp;n);
    for(int i = 1; i &lt;= n; ++i) scanf(&quot;%lld&quot;, &amp;num[i]);
    for(int i = 2; i &lt;= n; ++i)
    {
        scanf(&quot;%lld&quot;, &amp;dis[i][1]);
        for(int j = 2; ~p(i, j); ++j) dis[i][j] = dis[i][1] + dis[p(i, 1)][j - 1];
    }
    for(int i = n; i; --i)
        for(int j = 1; ~p(i, j); ++j)
        {
            dp[i][j][0] = dp[i][j][1] = 0x3f3f3f3f3f3f3f3f;
            int lson = ls, rson = rs;
            if((i &lt;&lt; 1) &gt; n)
            {
                dp[i][j][0] = dis[i][j] * num[p(i, j)];
                dp[i][j][1] = (dis[i][j] + dis[b(i, j)][1]) * num[b(i, j)];
            }
            else if((i &lt;&lt; 1 | 1) &gt; n)
            {
                dp[i][j][0] = dis[ls][1] * num[ls] + dp[ls][j + 1][0];
                dp[i][j][1] = dis[ls][1] * num[ls] + dp[ls][j + 1][1];
            }
            else
            {
                dp[i][j][0] = min(dp[i][j][0], dis[ls][1] * num[ls] + dp[ls][1][1] + dp[rs][j + 1][0]);
                dp[i][j][0] = min(dp[i][j][0], dis[rs][1] * num[rs] + dp[rs][1][1] + dp[ls][j + 1][0]);
                dp[i][j][1] = min(dp[i][j][1], dis[ls][1] * num[ls] + dp[ls][1][1] + dp[rs][j + 1][1]);
                dp[i][j][1] = min(dp[i][j][1], dis[rs][1] * num[rs] + dp[rs][1][1] + dp[ls][j + 1][1]);
            }
        }
    ll ans = 0x3f3f3f3f3f3f3f3f;
    for(int s = 1; s &lt;= n; ++s)
    {
        ll tmp = dp[s][1][0];
        for(int i = p(s, 1), lst = s; ~i; i = p(i, 1), lst = p(lst, 1))
        {
            if(b(lst, 1) &lt;= n) tmp += dis[b(lst, 1)][1] * num[b(lst, 1)] + dp[b(lst, 1)][2][0];
            else tmp += dis[i][1] * num[p(i, 1)];
        }
        ans = min(ans, tmp);
    }
    printf(&quot;%lld\n&quot;, ans);
    return 0;
}
</code></pre>
<h2 id="202024">2020.2.4</h2>
<p><a href="https://www.luogu.com.cn/problem/P4251">SCOI2015 小凸玩矩阵</a></p>
<p>二分，然后最大流判定即可。</p>
<p><a href="https://www.luogu.com.cn/record/30108560">YNOI2019 排队</a><br>
<a href="https://www.luogu.com.cn/problem/T79956">YNOI2019 数字游戏</a><br>
<a href="https://www.luogu.com.cn/problem/T79958">YNOI2019 逆序对</a></p>
<p>做了一下隔壁省的省选题，，这也太水了。。</p>
<p><a href="https://www.luogu.com.cn/problem/P4344">SHOI2015 脑洞治疗仪</a></p>
<p>线段树维护一个最大连续子段，修改的话可以在线段树上一层层递归下去，直到当前区间能全部一次改成1再修改，时间复杂度是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(nlog^2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>的。<br>
数据结构题有点难写，放个代码吧。</p>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;

const int MAXN = 200010;
#define ls (o &lt;&lt; 1)
#define rs (o &lt;&lt; 1 | 1)

struct Node
{
   int l, r, lazy;
   int sum, Sum;
}t[MAXN &lt;&lt; 2];

int n, m, tot, cnt;

Node pushup(int l, int r, Node a, Node b, int tag)
{
   Node o = (Node){a.l, b.r, tag, a.r + b.l, a.Sum + b.Sum};
   int mid = (l + r) &gt;&gt; 1;
   if(a.l == mid - l + 1) o.l += b.l;
   if(b.r == r - mid) o.r += a.r;
   o.sum = max(o.sum, max(a.sum, b.sum));
   o.sum = max(o.sum, max(o.l, o.r));
   return o;
}

void pushdown(int o, int l, int r)
{
   int tag = t[o].lazy;
   t[o].lazy = -1;
   if(tag == -1) return;
   int mid = (l + r) &gt;&gt; 1;
   t[ls].Sum = tag * (mid - l + 1);
   t[ls].sum = t[ls].l = t[ls].r = (tag == 0) * (mid - l + 1);
   t[ls].lazy = tag;
   t[rs].Sum = tag * (r - mid);
   t[rs].sum = t[rs].l = t[rs].r = (tag == 0) * (r - mid);
   t[rs].lazy = tag;
}

void change0(int o, int l, int r, int L, int R)
{
   if(l == L &amp;&amp; r == R)
   {
       t[o].Sum = 0;
       t[o].sum = t[o].l = t[o].r = r - l + 1;
       t[o].lazy = 0;
       return;
   }
   pushdown(o, l, r);
   int mid = (l + r) &gt;&gt; 1;
   if(R &lt;= mid) change0(ls, l, mid, L, R);
   else if(L &gt; mid) change0(rs, mid + 1, r, L, R);
   else change0(ls, l, mid, L, mid), change0(rs, mid + 1, r, mid + 1, R);
   t[o] = pushup(l, r, t[ls], t[rs], t[o].lazy);
}

void change1(int o, int l, int r)
{
   if(!cnt) return;
   if(t[o].Sum == r - l + 1) return;
   if(!t[o].Sum &amp;&amp; cnt &gt;= r - l + 1)
   {
       t[o].Sum = r - l + 1;
       t[o].sum = t[o].l = t[o].r = 0;
       t[o].lazy = 1;
       cnt -= r - l + 1, tot += r - l + 1;
       return;
   }
   if(l &gt;= r) return;
   pushdown(o, l, r);
   int mid = (l + r) &gt;&gt; 1;
   change1(ls, l, mid); change1(rs, mid + 1, r);
   t[o] = pushup(l, r, t[ls], t[rs], t[o].lazy);
}

void modify(int o, int l, int r, int L, int R, int tag)
{
   if(tot &gt;= tag) return;
   if(l == L &amp;&amp; r == R)
   {
       cnt = tag - tot;
       change1(o, l, r);
       return;
   }
   pushdown(o, l, r);
   int mid = (l + r) &gt;&gt; 1;
   if(R &lt;= mid) modify(ls, l, mid, L, R, tag);
   else if(L &gt; mid) modify(rs, mid + 1, r, L, R, tag);
   else modify(ls, l, mid, L, mid, tag), modify(rs, mid + 1, r, mid + 1, R, tag);
   t[o] = pushup(l, r, t[ls], t[rs], t[o].lazy);
}

int ask1(int o, int l, int r, int L, int R)
{
   if(l == L &amp;&amp; r == R) return t[o].Sum;
   pushdown(o, l, r);
   int mid = (l + r) &gt;&gt; 1;
   if(R &lt;= mid) return ask1(ls, l, mid, L, R);
   else if(L &gt; mid) return ask1(rs, mid + 1, r, L, R);
   else return ask1(ls, l, mid, L, mid) + ask1(rs, mid + 1, r, mid + 1, R);
}

Node ask2(int o, int l, int r, int L, int R)
{
   if(l == L &amp;&amp; r == R) return t[o];
   pushdown(o, l, r);
   int mid = (l + r) &gt;&gt; 1;
   if(R &lt;= mid) return ask2(ls, l, mid, L, R);
   else if(L &gt; mid) return ask2(rs, mid + 1, r, L, R);
   Node a = ask2(ls, l, mid, L, mid), b = ask2(rs, mid + 1, r, mid + 1, R);
   return pushup(l, r, a, b, -1);
}

int main()
{
   scanf(&quot;%d %d&quot;, &amp;n, &amp;m);
   t[1].lazy = 1, t[1].Sum = n;
   for(int i = 1; i &lt;= m; ++i)
   {
       int op, l, r, l1, r1;
       scanf(&quot;%d %d %d&quot;, &amp;op, &amp;l, &amp;r);
       if(!op) change0(1, 1, n, l, r);
       else if(op == 1)
       {
           scanf(&quot;%d %d&quot;, &amp;l1, &amp;r1);
           int tag = ask1(1, 1, n, l, r);
           change0(1, 1, n, l, r);
           if(tag) tot = cnt = 0, modify(1, 1, n, l1, r1, tag);
       }
       else if(op == 2) printf(&quot;%d\n&quot;, ask2(1, 1, n, l, r).sum);
   }
   return 0;
}
</code></pre>
<h2 id="202025">2020.2.5</h2>
<p><a href="https://www.luogu.com.cn/problem/P4585">FJOI2015 火星商店问题</a></p>
<p>线段树套可持久化Trie，每个节点用Vector存一下时间，查询的时候二分即可。<br>
顺便复习了一下可持久化结构。</p>
<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;

const int MAXN = 100010;
#define ls (o &lt;&lt; 1)
#define rs (o &lt;&lt; 1 | 1)

int n, m, rt[MAXN];

struct Trie
{
   int ch[2], sum;
}t[MAXN * 120];
int cnt = 0;

void ins(int&amp; o, int p, int d, int val)
{
   o = ++cnt, t[o] = t[p];
   ++t[o].sum;
   if(d == -1) return;
   bool c = (val &amp; (1 &lt;&lt; d));
   ins(t[o].ch[c], t[p].ch[c], d - 1, val);
}

int ask(int l, int r, int d, int val)
{
   if(d == -1 || (!l &amp;&amp; !r)) return 0;
   bool c = (val &amp; (1 &lt;&lt; d));
   if(t[t[r].ch[!c]].sum - t[t[l].ch[!c]].sum &gt; 0) return (1 &lt;&lt; d) + ask(t[l].ch[!c], t[r].ch[!c], d - 1, val);
   else return ask(t[l].ch[c], t[r].ch[c], d - 1, val);
}

struct Node
{
   vector&lt;int&gt; times, ids;
   int nowrt;
}s[MAXN &lt;&lt; 2];

void build(int o, int l, int r)
{
   s[o].times.push_back(0);
   s[o].ids.push_back(0);
   s[o].nowrt = 0;
   if(l == r) return;
   int mid = (l + r) &gt;&gt; 1;
   build(ls, l, mid);
   build(rs, mid + 1, r);
}

void modify(int o, int l, int r, int pos, int val, int day)
{
   s[o].times.push_back(day);
   int copy = 0;
   ins(copy, s[o].nowrt, 17, val);
   s[o].ids.push_back(copy);
   s[o].nowrt = copy;
   if(l == r) return;
   int mid = (l + r) &gt;&gt; 1;
   if(pos &lt;= mid) modify(ls, l, mid, pos, val, day);
   else modify(rs, mid + 1, r, pos, val, day);
}

int query(int o, int l, int r, int L, int R, int x, int d, int day)
{
   if(L &lt;= l &amp;&amp; r &lt;= R)
   {
       if(s[o].times.size() &lt;= 1 || s[o].times.back() &lt; day - d + 1) return 0;
       int siz = (int)s[o].times.size();
       int l = 1, r = siz - 1, ans = siz - 1;
       while(l &lt;= r)
       {
           int mid = (l + r) &gt;&gt; 1;
           if(s[o].times[mid] &gt;= day - d + 1) ans = mid, r = mid - 1;
           else l = mid + 1;
       }
       return ask(s[o].ids[ans - 1], s[o].nowrt, 17, x);
   }
   int mid = (l + r) &gt;&gt; 1, res = 0;
   if(L &lt;= mid) res = max(res, query(ls, l, mid, L, R, x, d, day));
   if(R &gt; mid) res = max(res, query(rs, mid + 1, r, L, R, x, d, day));
   return res;
}

int main()
{
   int day = 0;
   scanf(&quot;%d %d&quot;, &amp;n, &amp;m);
   for(int i = 1; i &lt;= n; ++i)
   {
       int x; scanf(&quot;%d&quot;, &amp;x);
       ins(rt[i], rt[i - 1], 17, x);
   }
   build(1, 1, n);
   while(m--)
   {
       int op, l, r, x, d;
       scanf(&quot;%d&quot;, &amp;op);
       if(!op) ++day;
       if(!op)
       {
           scanf(&quot;%d %d&quot;, &amp;x, &amp;d);
           modify(1, 1, n, x, d, day);
       }
       else if(op == 1)
       {
           scanf(&quot;%d %d %d %d&quot;, &amp;l, &amp;r, &amp;x, &amp;d);
           int ans = ask(rt[l - 1], rt[r], 17, x);
           ans = max(ans, query(1, 1, n, l, r, x, d, day));
           printf(&quot;%d\n&quot;, ans);
       }
   }
   return 0;
}
</code></pre>
<h2 id="202026">2020.2.6</h2>
<p><a href="https://www.luogu.com.cn/problem/P4629">SHOI2015 聚变反应炉</a></p>
<p>二合一的题目，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>&lt;</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c_i&lt;=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时贪心，否则做一个类似背包的树形DP即可。</p>
<p><a href="https://www.luogu.com.cn/problem/P5043">BJOI2015 树的同构</a></p>
<p>做法很多，什么最小表示法等等，不过直接简单粗暴的树哈希就可以了。</p>
<h2 id="202027">2020.2.7</h2>
<p><a href="https://www.luogu.com.cn/problem/P5502">JSOI2015 最大公约数</a></p>
<p>有一个性质：长度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>的序列的所有子序列的公约数最多只有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">logn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">n</span></span></span></span>个<br>
于是直接枚举右端点，维护这些公约数即可。<br>
PS：这个性质在许多和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">gcd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span></span></span></span>有关的题目中都挺好用的。</p>
<pre><code class="language-cpp">#include &lt;bits/stdc++.h&gt;
using namespace std;

typedef long long ll;

const int MAXN = 100010;

ll gcd(ll a, ll b)

{
	if(!b) return a;
	return gcd(b, a % b);

}

int n; ll ans, a[MAXN];
ll pos[MAXN], num[MAXN];

int main()
{
	scanf(&quot;%d&quot;, &amp;n);
	for(int i = 1; i &lt;= n; ++i) scanf(&quot;%lld&quot;, &amp;a[i]);
	int now = 0;
	for(int i = 1; i &lt;= n; ++i)
	{
		++now;
		pos[now] = i;
		num[now] = a[i];
		for(int j = now - 1; j; --j) num[j] = gcd(num[j], num[j + 1]);
		int k = 0, j = 1;
		while(j &lt;= now)
		{
			++k;
			pos[k] = pos[j];

			num[k] = num[j];

			while(num[k] == num[j]) ++j;

		}
		now = k;
		for(j = 1; j &lt;= now; ++j) ans = max(ans, (i - pos[j] + 1) * num[j]);
	}
	printf(&quot;%lld\n&quot;, ans);
	return 0;
}
</code></pre>
<h2 id="202028">2020.2.8</h2>
<p><a href="https://www.luogu.com.cn/problem/P3183">HAOI2016 食物链</a></p>
<p>以前生物课上就脑补过这个问题，，直接按拓扑序DP就行了。</p>
<p><a href="https://www.luogu.com.cn/problem/P2825">HEOI2016/TJOI2016 游戏</a></p>
<p>二分图匹配，提取出所有连续的不含#的子段，在每一个*的地方连边即可。</p>
<p><a href="https://www.luogu.com.cn/problem/P3267">JLOI2016/SHOI2016 侦察守卫</a></p>
<p>树形DP，这个状态设得好神仙啊，看完题解后都还有点懵。</p>
<h2 id="202029">2020.2.9</h2>
<p><a href="https://www.luogu.com.cn/problem/P3736">HAOI2016 字符合并</a></p>
<p>区间DP+状压DP，转移的时候要注意一下特殊情况。</p>
<h2 id="2020210">2020.2.10</h2>
<p><a href="https://www.luogu.com.cn/problem/P4067">SDOI2016储能表</a></p>
<p>数位DP，取模的时候要注意，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>18</mn></msup></mrow><annotation encoding="application/x-tex">10^{18}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span>的范围一不小心就爆掉了。</p>
<p><a href="https://www.luogu.com.cn/problem/P4068">SDOI2016 数字配对</a></p>
<p>费用流。这个利用质因数指数之和来判断<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>a</mi><mi>i</mi></msub><msub><mi>a</mi><mi>j</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{a_i}{a_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.253812em;vertical-align:-0.5423199999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7114919999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423199999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>是否是质数的想法太妙了。</p>
<h2 id="2020211">2020.2.11</h2>
<p><a href="https://www.luogu.com.cn/problem/P3698">CQOI2017 小Q的棋盘</a></p>
<p>贪心，沿着最长链走。</p>
<p><a href="https://www.luogu.com.cn/problem/P3758">TJOI2017 可乐</a></p>
<p>矩阵快速幂。因为数组没清零硬是调了一个下午。</p>
<p><a href="https://www.luogu.com.cn/problem/P4092">HEOI2016/TJOI2016 树</a></p>
<p>树链剖分，维护深度即可。</p>
<h2 id="2020212">2020.2.12</h2>
<p><a href="https://www.luogu.com.cn/problem/P4079">SDOI2016 齿轮</a></p>
<p>题目有点难读懂，不过读懂后就好做了，写个分数类然后dfs即可。</p>
<p><a href="https://www.luogu.com.cn/blog/Kesdiael3/hou-zhui-zi-dong-ji-yang-xie">史上最通俗的后缀自动机详解</a></p>
<p>学习SAM，之前学过现在又差不多忘了，之后会写一篇博客以便强化记忆。</p>
<h2 id="2020213">2020.2.13</h2>
<p><a href="https://aegirss.github.io/post/hou-zhui-zi-dong-ji-xue-xi-bi-ji/">后缀自动机学习笔记</a></p>
<h2 id="2020215">2020.2.15</h2>
<p><a href="https://www.luogu.com.cn/problem/P4072">SDOI2016 征途</a></p>
<p>斜率优化DP，拆开式子化一下就好了。</p>
<p><a href="https://www.luogu.com.cn/problem/P4093">HEOI2016/TJOI2016 序列</a></p>
<p>DP的式子本质上是个三维偏序，CDQ分治。</p>
<p><a href="https://www.luogu.com.cn/problem/P4340">SHOI2016 随机序列</a></p>
<p>线段树。这题神啊。</p>
<h2 id="2020216">2020.2.16</h2>
<p><a href="https://www.luogu.com.cn/problem/P4357">CQOI2016 K远点对</a></p>
<p>KD-Tree，注意一对点会被统计两次。</p>
<h2 id="2020218">2020.2.18</h2>
<p><a href="https://www.luogu.com.cn/problem/P4336">SHOI2016 黑暗前的幻想乡</a></p>
<p>容斥原理+Matrix-Tree定理。</p>
<h2 id="2020219">2020.2.19</h2>
<p><a href="https://www.luogu.com.cn/problem/P4124">CQOI2016 手机号码</a></p>
<p>数位DP。</p>
<p><a href="https://www.luogu.com.cn/problem/P4123">CQOI2016 不同的最小割</a></p>
<p>最小割树模板题，新技能get。</p>
<h2 id="2020220">2020.2.20</h2>
<p><a href="https://www.luogu.com.cn/problem/P4358">CQOI2016 密钥破解</a></p>
<p>破解RSA加密，用Pollard rho算法分解质因数。</p>
<p><a href="https://www.luogu.com.cn/problem/P4359">CQOI2016 伪光滑数</a></p>
<p>用堆维护，枚举的时候要注意避免重复。</p>
<h2 id="2020221">2020.2.21</h2>
<p><a href="https://www.luogu.com.cn/problem/P4587">FJOI2016 神秘数</a></p>
<p>主席树。</p>
<p><a href="https://www.luogu.com.cn/problem/P4609">FJOI2016 建筑师</a></p>
<p>组合数学，第一类斯特林数。</p>
<p><a href="https://www.luogu.com.cn/problem/P5459">BJOI2016 回转寿司</a></p>
<p>没必要离散化，直接用动态开点线段树就行了，内存刚好够。</p>
<h2 id="2020222">2020.2.22</h2>
<p><a href="https://www.luogu.com.cn/problem/P4608">FJOI2016 所有公共子序列问题</a></p>
<p>序列自动机上DP，注意这题要写压位高精。</p>
<h2 id="2020223">2020.2.23</h2>
<p>XJOI-提高</p>
<p>T1：枚举每个数，直接模拟就行了。</p>
<p>T2：把矩形沿着对角线对折，然后跑最短路。</p>
<p>T3：不会，，写了个30分的DFS套DFS。</p>
<p>XJOI-省选</p>
<p>看了一下都不会做，，，前两个题写了个暴力</p>
<p>T3随便写了写，居然有70分，，，</p>
<h2 id="2020224">2020.2.24</h2>
<p><a href="https://www.luogu.com.cn/problem/P3760">TJOI2017 异或和</a></p>
<p>按位枚举，然后权值树状数组维护。</p>
<p><a href="https://www.luogu.com.cn/problem/P3761">TJOI2017 城市</a></p>
<p>枚举每条边，然后求一下两个联通块的半径和直径即可。</p>
<h2 id="2020226">2020.2.26</h2>
<p><a href="https://www.luogu.com.cn/problem/P3745">六省联考2017 期末考试</a></p>
<p>发现代价只与结束时间有关，枚举结束时间贪心即可。</p>
<p><a href="https://www.luogu.com.cn/problem/P3750">六省联考2017 分手是祝愿</a></p>
<p>神仙题啊！这个DP真的神奇。</p>
<h2 id="2020227">2020.2.27</h2>
<p><a href="https://www.luogu.com.cn/problem/P3749">六省联考2017 寿司餐厅</a></p>
<p>注意到权值不重复计算，从而想到最大权闭合子图，然后建图求最小割。</p>
<h2 id="2020229">2020.2.29</h2>
<p><a href="https://www.luogu.com.cn/problem/P3746">六省联考2017 组合数问题</a></p>
<p>考虑组合意义，然后DP，矩阵加速。</p>
<p><a href="https://www.luogu.com.cn/problem/P3705">SDOI2017 新生舞会</a></p>
<p>分数规划套费用流</p>

              </div>
              <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong>本文作者：</strong>
      Aegir
    </li>
    <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://Aegirss.github.io/post/zuo-ti-andxue-xi-ji-lu-2-yue/" title="做题&amp;学习记录（2月）">做题&amp;学习记录（2月）</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明： </strong>
      本博客所有文章除特别声明外，转载请注明出处！
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://Aegirss.github.io/tag/1BGdjUVip/"># 总结</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="杜教筛" href="https://Aegirss.github.io/post/du-jiao-shai/">杜教筛</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="杜教筛" href="https://Aegirss.github.io/post/du-jiao-shai/">上一篇</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="莫比乌斯反演" href="https://Aegirss.github.io/post/mo-bi-wu-si-fan-yan/">莫比乌斯反演</a>
        <a class="nav-mobile-next" title="莫比乌斯反演" href="https://Aegirss.github.io/post/mo-bi-wu-si-fan-yan/">下一篇</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
              
                
                  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: [''],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })
  gitalk.render('gitalk-container')
</script>
                
                
              
            </div>
          </div>
        </div>
      </div>
      <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      © 2019-2020 <i class="fa fa-heart"></i> HsxyHao
    </div>
    <div class="poweredby">
      Powered by  <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
  </footer>
  
  
  <div class="pisces back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
    <link rel="stylesheet" href="/media/live2d/histoire/css/live2d.css" />
<div class="box-scale">
  <div id="landlord" style="left:5px;bottom:0px;" data-key="">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="500" height="560" class="live2d"></canvas>
    <div class="live_talk_input_body">
      <div class="live_talk_input_name_body">
        <input name="name" type="text" class="live_talk_name white_input" id="AIuserName" autocomplete="off" placeholder="你的名字" />
      </div>
      <div class="live_talk_input_text_body">
        <input name="talk" type="text" class="live_talk_talk white_input" id="AIuserText" autocomplete="off" placeholder="要和我聊什么呀？"/>
        <button type="button" class="live_talk_send_btn" id="talk_send">发送</button>
      </div>
    </div>
    <input name="live_talk" id="live_talk" value="1" type="hidden" />
    <div class="live_ico_box">
      <div class="live_ico_item type_info" id="showInfoBtn"></div>
      <div class="live_ico_item type_talk" id="showTalkBtn"></div>
      
      <div class="live_ico_item type_youdu" id="youduButton"></div>
      <div class="live_ico_item type_quit" id="hideButton"></div>
      <input name="live_statu_val" id="live_statu_val" value="0" type="hidden" />
      <audio src="" style="display:none;" id="live2d_bgm" data-bgm="0" preload="none"></audio>
      <input id="duType" value="douqilai" type="hidden">
      
    </div>
  </div>
</div>
<div id="open_live2d">召唤伊斯特瓦尔</div>
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
var message_Path = '/media/live2d/histoire/';
let landlord = document.querySelector('#landlord');
var apiKey = landlord.dataset.key;
</script>
<script type="text/javascript" src="/media/live2d/histoire/js/live2d.js"></script>
<script type="text/javascript" src="/media/live2d/histoire/js/message.js"></script>
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // 动态调整站点概览高度
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // 代码高亮
  hljs.initHighlightingOnLoad();
</script>
    </div>
  </body>
  <script src="/media/js/motion.js"></script>
</html>